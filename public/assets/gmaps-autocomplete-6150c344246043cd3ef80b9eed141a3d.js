var GmapsAutoComplete={geocoder:null,map:null,marker:null,inputField:null,errorField:null,positionOutputter:null,updateUI:null,updateMap:null,region:null,country:null,debugOn:!1,mapElem:document.getElementById("gmaps-canvas"),zoomLevel:2,mapType:google.maps.MapTypeId.ROADMAP,pos:[51.751724,-1.255284],inputField:"#gmaps-input-address",errorField:"#gmaps-error",positionOutputter:this.defaultPositionOutputter,defaultOptions:{mapElem:"#gmaps-canvas",zoomLevel:2,mapType:google.maps.MapTypeId.ROADMAP,pos:[51.751724,-1.255284],inputField:"#gmaps-input-address",errorField:"#gmaps-error",debugOn:!1},init:function(t){t=t||{};var e=jQuery.extend(!0,{},t),t=$.extend(!0,{},this.defaultOptions,t),i=t.pos,n=i[0],s=i[1],o=t.mapType,r=null;t.mapElem&&(r=$(t.mapElem).get(0));var a=t.zoomLevel;this.inputField=t.inputField,this.errorField=t["#gmaps-error"],this.debugOn=t.debugOn,this.positionOutputter=t.positionOutputter||this.defaultPositionOutputter,this.updateUI=t.updateUI||this.defaultUpdateUI,this.updateMap=t.updateMap||this.defaultUpdateMap,this.debug("called with opts",e),this.debug("defaultOptions",this.defaultOptions),this.debug("options after merge with defaults",t);var l=new google.maps.LatLng(n,s);this.debug("lat,lng",l);var u={zoom:a,center:l,mapTypeId:o};this.debug("map options",u),this.geocoder=new google.maps.Geocoder;var c=this;"undefined"==typeof r&&this.showError("Map element "+t.mapElem+" could not be resolved!"),c.debug("mapElem",this.mapElem),r&&(this.map=new google.maps.Map(r,u),this.map&&(this.marker=new google.maps.Marker({map:this.map,draggable:!0}),c.addMapListeners(this.marker,this.map)))},debug:function(t,e){this.debugOn&&console.log(t,e)},addMapListeners:function(t,e){self=this,google.maps.event.addListener(t,"dragend",function(){self.geocodeLookup("latLng",t.getPosition())}),google.maps.event.addListener(e,"click",function(e){t.setPosition(e.latLng),self.geocodeLookup("latLng",e.latLng)})},defaultUpdateMap:function(t){var e=this.map,i=this.marker;e&&e.fitBounds(t.viewport),i&&i.setPosition(t.location)},defaultUpdateUI:function(t,e){$(this.inputField).autocomplete("close"),this.debug("country",this.country);var i=t.replace(", "+this.country,""),i=t;this.debug("updateAdr",i),$(this.inputField).val(i),this.positionOutputter(e)},defaultPositionOutputter:function(t){$("#gmaps-output-latitude").html(t.lat()),$("#gmaps-output-longitude").html(t.lng())},geocodeLookup:function(t,e,i){i="undefined"!=typeof i?i:!1,request={},request[t]=e,this.geocoder.geocode(request,performGeocode)},performGeocode:function(t,e){this.debug("performGeocode",e),$(self.errorField).html(""),e==google.maps.GeocoderStatus.OK?self.geocodeSuccess(t):self.geocodeFailure(type,value)},geocodeSuccess:function(t){this.debug("geocodeSuccess",t),t[0]?(this.updateUI(t[0].formatted_address,t[0].geometry.location),update&&this.updateMap(t[0].geometry)):this.showError(this.geocodeErrorMsg())},geocodeFailure:function(t,e){this.debug("geocodeFailure",t),"address"==t?this.showError(this.invalidAddressMsg(e)):(this.showError(this.noAddressFoundMsg()),this.updateUI("",e))},geocodeErrorMsg:function(){"Sorry, something went wrong. Try again!"},invalidAddressMsg:function(t){},noAddressFoundMsg:function(){"Woah... that's pretty remote! You're going to have to manually enter a place name."},showError:function(t){$(this.errorField).html(t),$(this.errorField).show(),setTimeout(function(){$(this.errorField).hide()},1e3)},autoCompleteInit:function(t){t=t||{},this.region=t.region||"DK",this.country=t.country||"Denmark",this.debug("region",this.region);var e=this;$(this.inputField).autocomplete({select:function(t,i){e.updateUI(i.item.value,i.item.geocode.geometry.location),e.updateMap(i.item.geocode.geometry)},source:function(t,i){var n="",s=e.region;s&&(n=", "+s);var o=t.term+n;e.debug("geocode address",o);var r={address:o};e.geocoder.geocode(r,function(t){i($.map(t,function(t){var i=t.formatted_address.replace(", "+e.country,"");return{label:i,value:i,geocode:t}}))})}}),$(e.inputField).bind("keydown",this.keyDownHandler)},keyDownHandler:function(t){13==t.keyCode?(this.geocodeLookup("address",$(self.inputField).val(),!0),$(this.inputField).autocomplete("disable")):$(this.inputField).autocomplete("enable")}};