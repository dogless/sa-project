(function(){this.Gmaps={build:function(e,t){var n;return null==t&&(t={}),new(n=_.isFunction(t.handler)?t.handler:Gmaps.Objects.Handler)(e,t)},Builders:{},Objects:{},Google:{Objects:{},Builders:{}}}}).call(this),function(){var e,t=[].indexOf||function(e){for(var t=0,n=this.length;n>t;t++)if(t in this&&this[t]===e)return t;return-1};e=["extended","included"],this.Gmaps.Base=function(){function n(){}return n.extend=function(n){var r,i,o;for(r in n)i=n[r],t.call(e,r)<0&&(this[r]=i);return null!=(o=n.extended)&&o.apply(this),this},n.include=function(n){var r,i,o;for(r in n)i=n[r],t.call(e,r)<0&&(this.prototype[r]=i);return null!=(o=n.included)&&o.apply(this),this},n}()}.call(this),function(){this.Gmaps.Objects.BaseBuilder=function(){function e(){}return e.prototype.build=function(){return new(this.model_class())(this.serviceObject)},e.prototype.before_init=function(){},e.prototype.after_init=function(){},e.prototype.addListener=function(e,t){return this.primitives().addListener(this.getServiceObject(),e,t)},e.prototype.getServiceObject=function(){return this.serviceObject},e.prototype.primitives=function(){return this.constructor.PRIMITIVES},e.prototype.model_class=function(){return this.constructor.OBJECT},e}()}.call(this),function(){this.Gmaps.Objects.Builders=function(e,t,n){return{build:function(r,i,o){var a;return t.PRIMITIVES=n,e.OBJECT=t,e.PRIMITIVES=n,a=new e(r,i,o),a.build()}}}}.call(this),function(){this.Gmaps.Objects.Handler=function(){function e(e,t){this.type=e,null==t&&(t={}),this.setPrimitives(t),this.setOptions(t),this._cacheAllBuilders(),this.resetBounds()}return e.prototype.buildMap=function(e,t){return null==t&&(t=function(){}),this.map=this._builder("Map").build(e,function(e){return function(){return e._createClusterer(),t()}}(this))},e.prototype.addMarkers=function(e,t){return _.map(e,function(e){return function(n){return e.addMarker(n,t)}}(this))},e.prototype.addMarker=function(e,t){var n;return n=this._builder("Marker").build(e,t,this.marker_options),n.setMap(this.getMap()),this.clusterer.addMarker(n),n},e.prototype.addCircles=function(e,t){return _.map(e,function(e){return function(n){return e.addCircle(n,t)}}(this))},e.prototype.addCircle=function(e,t){return this._addResource("circle",e,t)},e.prototype.addPolylines=function(e,t){return _.map(e,function(e){return function(n){return e.addPolyline(n,t)}}(this))},e.prototype.addPolyline=function(e,t){return this._addResource("polyline",e,t)},e.prototype.addPolygons=function(e,t){return _.map(e,function(e){return function(n){return e.addPolygon(n,t)}}(this))},e.prototype.addPolygon=function(e,t){return this._addResource("polygon",e,t)},e.prototype.addKmls=function(e,t){return _.map(e,function(e){return function(n){return e.addKml(n,t)}}(this))},e.prototype.addKml=function(e,t){return this._addResource("kml",e,t)},e.prototype.removeMarkers=function(e){return _.map(e,function(e){return function(t){return e.removeMarker(t)}}(this))},e.prototype.removeMarker=function(e){return e.clear(),this.clusterer.removeMarker(e)},e.prototype.fitMapToBounds=function(){return this.map.fitToBounds(this.bounds.getServiceObject())},e.prototype.getMap=function(){return this.map.getServiceObject()},e.prototype.setOptions=function(e){return this.marker_options=_.extend(this._default_marker_options(),e.markers),this.builders=_.extend(this._default_builders(),e.builders),this.models=_.extend(this._default_models(),e.models)},e.prototype.resetBounds=function(){return this.bounds=this._builder("Bound").build()},e.prototype.setPrimitives=function(e){return this.primitives=void 0===e.primitives?this._rootModule().Primitives():_.isFunction(e.primitives)?e.primitives():e.primitives},e.prototype.currentInfowindow=function(){return this.builders.Marker.CURRENT_INFOWINDOW},e.prototype._addResource=function(e,t,n){var r;return r=this._builder(e).build(t,n),r.setMap(this.getMap()),r},e.prototype._cacheAllBuilders=function(){var e;return e=this,_.each(["Bound","Circle","Clusterer","Kml","Map","Marker","Polygon","Polyline"],function(t){return e._builder(t)})},e.prototype._clusterize=function(){return _.isObject(this.marker_options.clusterer)},e.prototype._createClusterer=function(){return this.clusterer=this._builder("Clusterer").build({map:this.getMap()},this.marker_options.clusterer)},e.prototype._default_marker_options=function(){return _.clone({singleInfowindow:!0,maxRandomDistance:0,clusterer:{maxZoom:5,gridSize:50}})},e.prototype._builder=function(e){var t;return e=this._capitalize(e),null==this[t="__builder"+e]&&(this[t]=Gmaps.Objects.Builders(this.builders[e],this.models[e],this.primitives)),this["__builder"+e]},e.prototype._default_models=function(){var e;return e=_.clone(this._rootModule().Objects),this._clusterize()?e:(e.Clusterer=Gmaps.Objects.NullClusterer,e)},e.prototype._capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e.prototype._default_builders=function(){return _.clone(this._rootModule().Builders)},e.prototype._rootModule=function(){return null==this.__rootModule&&(this.__rootModule=Gmaps[this.type]),this.__rootModule},e}()}.call(this),function(){this.Gmaps.Objects.NullClusterer=function(){function e(){}return e.prototype.addMarkers=function(){},e.prototype.addMarker=function(){},e.prototype.clear=function(){},e.prototype.removeMarker=function(){},e}()}.call(this);